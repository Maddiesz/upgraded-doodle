<!DOCTYPE html>
<html>

<head>
    <title>Warehouse Requests Form</title>
    <script src="https://script.google.com/macros/s/AKfycbyF3ReVIhmCBxAbA7L72-XMhj56gy7Wfe5AtKxNpPPS5POsEO0Poi7ycOacGtubcxyV/exec"></script>
    <script>
        // Add a new row to the repeater
        function addRow() {
            var row = `
            <div class="row">
                <input type="text" name="fba_id[]" required placeholder="FBA ID">
                <input type="text" name="fba_reference[]" required placeholder="FBA Reference">
                <input type="number" name="no_units[]" required placeholder="No. Units">
                <input type="number" name="no_skus[]" required placeholder="No. SKUs">
                <button type="button" onclick="removeRow(this)">-</button>
            </div>
            `;
            $('#repeater').append(row);
        }

        // Remove a row from the repeater
        function removeRow(btn) {
            $(btn).closest('.row').remove();
        }

        // Submit form data to Google Apps Script
        function submitForm() {
            var brand = $('#brand').val();
            var email = $('#email').val();
            var fbaIds = $('[name="fba_id[]"]').map(function () { return $(this).val(); }).get();
            var fbaReferences = $('[name="fba_reference[]"]').map(function () { return $(this).val(); }).get();
            var noUnits = $('[name="no_units[]"]').map(function () { return $(this).val(); }).get();
            var noSkus = $('[name="no_skus[]"]').map(function () { return $(this).val(); }).get();
            var files = $('[name="files[]"]')[0].files;

            var formData = new FormData();
            formData.append('brand', brand);
            formData.append('email', email);
            for (var i = 0; i < fbaIds.length; i++) {
                formData.append('fba_id[]', fbaIds[i]);
                formData.append('fba_reference[]', fbaReferences[i]);
                formData.append('no_units[]', noUnits[i]);
                formData.append('no_skus[]', noSkus[i]);
            }
            for (var i = 0; i < files.length; i++) {
                formData.append('files[]', files[i]);
            }

            $.ajax({
                url: 'https://script.google.com/macros/s/AKfycbyF3ReVIhmCBxAbA7L72-XMhj56gy7Wfe5AtKxNpPPS5POsEO0Poi7ycOacGtubcxyV/exec',
                method: 'POST',
                data: formData,
                processData: false,
                contentType: false,
                success: function (response) {
                    console.log(response);
                    alert('Form data submitted successfully!');
                },
                error: function (xhr, status, error) {
                    console.error(xhr, status, error);
                    alert('Form data submission failed. Please try again.');
                }
            });
        }
    </script>
</head>

<body>
    <h1>Warehouse Requests Form</h1>
    <form>
        <label for="brand">Brand: </label>
        <input type="text" id="brand" required>
        <br>
        <label for="email">E-mail: </label>
        <input type="email" id="email" required>
        <br>
		<label for="files">Upload Files: </label>
        <input type="file" id="files" name="files[]" multiple required>
        <br>
        <h2>Warehouse Requests:</h2>
        <div id="repeater">
            <div class="row">
                <input type="text" name="fba_id[]" required placeholder="FBA ID">
                <input type="text" name="fba_reference[]" required placeholder="FBA Reference">
                <input type="number" name="no_units[]" required placeholder="No. Units">
                <input type="number" name="no_skus[]" required placeholder="No. SKUs">
                <button type="button" onclick="removeRow(this)">-</button>
            </div>
        </div>
        <button type="button" onclick="addRow()">Add Row</button>
        <br>
        <button type="button" onclick="submitForm()">Submit</button>
    </form>
</body>

</html>

       
