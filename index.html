<!DOCTYPE html>
<html>
<head>
  <title>Warehouse Requests Form</title>
  <style>
    .repeater-line {
      margin-bottom: 10px;
    }
  </style>
</head>
<body>
  <form id="warehouse-form">
    <label for="brand">Brand:</label>
    <input type="text" id="brand" name="brand" required><br><br>

    <label for="email">E-mail:</label>
    <input type="email" id="email" name="email" required><br><br>

    <div id="repeater-container"></div>

    <button type="button" onclick="addRow()">+ Add Row</button>
    <button type="button" onclick="removeRow()">- Remove Row</button><br><br>

    <label for="files">Attachments:</label>
    <input type="file" id="files" name="files[]" multiple><br><br>

    <button type="submit">Submit</button>
  </form>

  <script>
    function addRow() {
      var repeaterContainer = document.getElementById("repeater-container");
      var newRow = document.createElement("div");
      newRow.classList.add("repeater-line");
      newRow.innerHTML = `
        <label for="fba-id">FBA ID:</label>
        <input type="text" id="fba-id" name="fba_id[]"><br><br>

        <label for="fba-reference">FBA Reference:</label>
        <input type="text" id="fba-reference" name="fba_reference[]"><br><br>

        <label for="no-units">No. Units:</label>
        <input type="number" id="no-units" name="no_units[]"><br><br>

        <label for="no-skus">No. SKUs:</label>
        <input type="number" id="no-skus" name="no_skus[]"><br><br>
      `;
      repeaterContainer.appendChild(newRow);
    }

    function removeRow() {
      var repeaterContainer = document.getElementById("repeater-container");
      if (repeaterContainer.childElementCount > 0) {
        repeaterContainer.removeChild(repeaterContainer.lastChild);
      }
    }

    document.getElementById("warehouse-form").addEventListener("submit", function(event) {
      event.preventDefault();
      var form = event.target;
      var formData = new FormData(form);
      var xhr = new XMLHttpRequest();
      xhr.open("POST", "https://script.google.com/macros/s/AKfycbyF3ReVIhmCBxAbA7L72-XMhj56gy7Wfe5AtKxNpPPS5POsEO0Poi7ycOacGtubcxyV/exec"); // Replace with your Google Apps Script URL
      xhr.onload = function() {
        if (xhr.status === 200) {
          alert("Form data submitted successfully!");
          form.reset();
          var repeaterContainer = document.getElementById("repeater-container");
          while (repeaterContainer.firstChild) {
            repeaterContainer.removeChild(repeaterContainer.firstChild);
          }
        } else {
          alert("Error submitting form data. Please try again.");
        }
      };
      xhr.send(formData);
    });
  </script>
</body>
</html>
